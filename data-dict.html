<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Data dictionaries | OCA Data Sharing Practicals</title>
  <meta name="description" content="Chapter 2 Data dictionaries | OCA Data Sharing Practicals: Data dictionaries and pseudonymization" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Data dictionaries | OCA Data Sharing Practicals" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 2 Data dictionaries | OCA Data Sharing Practicals: Data dictionaries and pseudonymization" />
  <meta name="github-repo" content="epicentre-msf/OCA-training" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Data dictionaries | OCA Data Sharing Practicals" />
  
  <meta name="twitter:description" content="Chapter 2 Data dictionaries | OCA Data Sharing Practicals: Data dictionaries and pseudonymization" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="pseudonym.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">OCA Data Sharing Practicals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i><b>1.1</b> Setup</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-dict.html"><a href="data-dict.html"><i class="fa fa-check"></i><b>2</b> Data dictionaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-dict.html"><a href="data-dict.html#objectives"><i class="fa fa-check"></i><b>2.1</b> Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="data-dict.html"><a href="data-dict.html#background"><i class="fa fa-check"></i><b>2.2</b> Background</a></li>
<li class="chapter" data-level="2.3" data-path="data-dict.html"><a href="data-dict.html#dictionary-format"><i class="fa fa-check"></i><b>2.3</b> Dictionary format</a></li>
<li class="chapter" data-level="2.4" data-path="data-dict.html"><a href="data-dict.html#the-datadict-package"><i class="fa fa-check"></i><b>2.4</b> The <code>datadict</code> package</a></li>
<li class="chapter" data-level="2.5" data-path="data-dict.html"><a href="data-dict.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-dict.html"><a href="data-dict.html#exercise-1"><i class="fa fa-check"></i><b>2.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-dict.html"><a href="data-dict.html#exercise-2"><i class="fa fa-check"></i><b>2.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-dict.html"><a href="data-dict.html#exercise-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-dict.html"><a href="data-dict.html#exercise-4"><i class="fa fa-check"></i><b>2.5.4</b> Exercise 4</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-dict.html"><a href="data-dict.html#exercise-5"><i class="fa fa-check"></i><b>2.5.5</b> Exercise 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pseudonym.html"><a href="pseudonym.html"><i class="fa fa-check"></i><b>3</b> Pseudonymization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="pseudonym.html"><a href="pseudonym.html#objectives-1"><i class="fa fa-check"></i><b>3.1</b> Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="pseudonym.html"><a href="pseudonym.html#background-1"><i class="fa fa-check"></i><b>3.2</b> Background</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="pseudonym.html"><a href="pseudonym.html#disclosure"><i class="fa fa-check"></i><b>3.2.1</b> Disclosure</a></li>
<li class="chapter" data-level="3.2.2" data-path="pseudonym.html"><a href="pseudonym.html#identifiers"><i class="fa fa-check"></i><b>3.2.2</b> Identifiers</a></li>
<li class="chapter" data-level="3.2.3" data-path="pseudonym.html"><a href="pseudonym.html#k-anonymity"><i class="fa fa-check"></i><b>3.2.3</b> <em>k</em>-anonymity</a></li>
<li class="chapter" data-level="3.2.4" data-path="pseudonym.html"><a href="pseudonym.html#pseudonymization"><i class="fa fa-check"></i><b>3.2.4</b> Pseudonymization</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="pseudonym.html"><a href="pseudonym.html#typical-workflow"><i class="fa fa-check"></i><b>3.3</b> Typical workflow</a></li>
<li class="chapter" data-level="3.4" data-path="pseudonym.html"><a href="pseudonym.html#exercise"><i class="fa fa-check"></i><b>3.4</b> Exercise</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">OCA Data Sharing Practicals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-dict" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Data dictionaries<a href="data-dict.html#data-dict" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="objectives" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Objectives<a href="data-dict.html#objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Learn to:</p>
<ul>
<li>prepare an OCA-style data dictionary, starting from either a raw dataset or a ODK/Kobo dictionary</li>
<li>compare datasets and corresponding data dictionaries to ensure completeness and validity</li>
</ul>
</div>
<div id="background" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Background<a href="data-dict.html#background" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Documenting the variables in a dataset is a crucial part of data management and
ensures that a dataset is interpretable by researchers who were not directly
involved in study design or data collection. Whereas data files will generally
contain codenames for variables (e.g. <code>patagegrp</code> for “Patient’s age group”),
and sometimes also coded data values, the data dictionary describes each
variable and the set of possible values in plain language that is more broadly
interpretable.</p>
<p>Data collection platforms such as Kobo, REDCap, and OpenClinica have their own
specialized data dictionary format. To facilitate dataset and data dictionary
validation, the OCA Data Sharing Platform uses its own standardized dictionary
format, defined in the next section.</p>
</div>
<div id="dictionary-format" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Dictionary format<a href="data-dict.html#dictionary-format" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Every dataset shared or archived on the OCA platform must have an accompanying
data dictionary that includes, at a minimum, the fields described below. Each
variable in the dataset (i.e. each column) must have a dictionary entry for each
of the required fields.</p>
<table>
<colgroup>
<col width="36%" />
<col width="28%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th>Required field</th>
<th>Description</th>
<th>Example entry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>variable_name</td>
<td>Variable name (i.e. exact column name within the corresponding dataset)</td>
<td>“sample_type”</td>
</tr>
<tr class="even">
<td>short_label</td>
<td>Short phrase describing the variable in words</td>
<td>“Type of laboratory sample collected”</td>
</tr>
<tr class="odd">
<td>type</td>
<td>Variable type (options: “Numeric”, “Date”, “Time”, “Datetime”, “Coded list”, or “Free text”)</td>
<td>“Coded list”</td>
</tr>
<tr class="even">
<td>choices</td>
<td>The list of options (pairs of codes and labels) corresponding to a variable of type “Coded list”.</td>
<td>“1, Blood | 2, Nasal swab | 3, Throat swab | 4, Other”</td>
</tr>
<tr class="odd">
<td>origin</td>
<td>Was the variable a part of the original data collection instrument (option “original”), or was it later derived (option “derived”)</td>
<td>“original”</td>
</tr>
<tr class="even">
<td>status</td>
<td>Is the variable shared (option “shared”), or withheld to reduce disclosure risk (option “withheld”) ?</td>
<td>“shared”</td>
</tr>
</tbody>
</table>
</div>
<div id="the-datadict-package" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> The <code>datadict</code> package<a href="data-dict.html#the-datadict-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The R package <a href="https://github.com/epicentre-msf/datadict"><code>datadict</code></a> contains a
variety of functions to aid in the preparation of an OCA-style data dictionary:</p>
<ul>
<li><code>dict_from_data()</code>: prepare a dictionary template from a raw dataset</li>
<li><code>dict_from_odk()</code>: prepare a dictionary template from an ODK/Kobo dictionary</li>
<li><code>dict_from_redcap()</code>: prepare a dictionary template from a REDCap dictionary</li>
<li><code>valid_dict()</code>: verify that a dictionary is consistent with the OCA format</li>
<li><code>valid_data()</code>: verify that a dataset corresponds to its associated data dictionary</li>
</ul>
<p>Note that dictionary templates produces by the <code>dict_from_</code> functions may still
require further processing by the user (e.g. with additional R scripts, or by
hand in Excel).</p>
</div>
<div id="exercises" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Exercises<a href="data-dict.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This repository includes an example dataset based on a mortality survey, and
corresponding ODK data dictionary (see section <a href="index.html#setup">1.1 Setup</a> for data
download links). Load the dataset and data dictionary using the example code
below (note you may need to modify the file path, depending on how you setup
your project), and work through the following exercises using functions from the
<code>datadict</code> package where possible.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-dict.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb2-2"><a href="data-dict.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-3"><a href="data-dict.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="data-dict.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import dataset</span></span>
<span id="cb2-5"><a href="data-dict.html#cb2-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data/mortality_survey_simple_data.xlsx&quot;</span>), <span class="at">setclass =</span> <span class="st">&quot;tbl&quot;</span>)</span>
<span id="cb2-6"><a href="data-dict.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="data-dict.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># import ODK dictionary (note the main dictionary and multiple-choice options are in separate sheets)</span></span>
<span id="cb2-8"><a href="data-dict.html#cb2-8" aria-hidden="true" tabindex="-1"></a>odk_survey <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data/mortality_survey_simple_kobo.xlsx&quot;</span>), <span class="at">sheet =</span> <span class="st">&quot;survey&quot;</span>, <span class="at">setclass =</span> <span class="st">&quot;tbl&quot;</span>)</span>
<span id="cb2-9"><a href="data-dict.html#cb2-9" aria-hidden="true" tabindex="-1"></a>odk_choices <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data/mortality_survey_simple_kobo.xlsx&quot;</span>), <span class="at">sheet =</span> <span class="st">&quot;choices&quot;</span>, <span class="at">setclass =</span> <span class="st">&quot;tbl&quot;</span>)</span></code></pre></div>
<div id="exercise-1" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Exercise 1<a href="data-dict.html#exercise-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the <code>datadict</code> package we can prepare a dictionary template <em>either</em> from
the raw dataset (using function <code>dict_from_data()</code>) or from the ODK dictionary
(using function <code>dict_from_odk()</code>). Try both approaches separately and compare
the resulting dictionary templates. What are some differences? Can you guess why
these differences are occurring?</p>
<details style="color:#b30000">
<summary>
<b>See proposed answer</b>
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-dict.html#cb3-1" aria-hidden="true" tabindex="-1"></a>dict_dat <span class="ot">&lt;-</span> datadict<span class="sc">::</span><span class="fu">dict_from_data</span>(dat)</span>
<span id="cb3-2"><a href="data-dict.html#cb3-2" aria-hidden="true" tabindex="-1"></a>dict_odk <span class="ot">&lt;-</span> datadict<span class="sc">::</span><span class="fu">dict_from_odk</span>(odk_survey, odk_choices)</span>
<span id="cb3-3"><a href="data-dict.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="data-dict.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">here</span>(<span class="st">&quot;output&quot;</span>))) <span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">&quot;output&quot;</span>))</span>
<span id="cb3-5"><a href="data-dict.html#cb3-5" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(dict_dat, <span class="fu">here</span>(<span class="st">&quot;output/ex1_dict_dat.xlsx&quot;</span>))</span>
<span id="cb3-6"><a href="data-dict.html#cb3-6" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(dict_odk, <span class="fu">here</span>(<span class="st">&quot;output/ex1_dict_odk.xlsx&quot;</span>))</span></code></pre></div>
<ul>
<li>Function <code>dict_from_data()</code> doesn’t populate column <code>short_label</code>, whereas
<code>dict_from_odk()</code> does</li>
<li>Variable types in column <code>type</code> are different. Function <code>dict_from_data()</code>
guesses only ‘Free text’ and ‘Coded list’, whereas <code>dict_from_odk()</code> also
returns ‘Date’ and ‘Numeric’</li>
</ul>
</details>
</div>
<div id="exercise-2" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Exercise 2<a href="data-dict.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When producing a dictionary template using <code>dict_from_data()</code>, the variable type
is determined by the class of the original column (e.g. character, numeric,
Date). The column classes that are read in by e.g. <code>rio::import()</code> might not
always correspond to the variable types that we have in mind (e.g. numbers,
dates, and times are sometimes read in as class “character”). Where necessary,
transform the columns of <code>dat</code> using functions like <code>as.numeric()</code> or
<code>as.Date()</code> and then produce another dictionary template using
<code>dict_from_data()</code>. What are the differences that remain between this dictionary
template and the template derived from the ODK dictionary?</p>
<details style="color:#b30000">
<summary>
<b>See proposed answer</b>
</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-dict.html#cb4-1" aria-hidden="true" tabindex="-1"></a>vars_date <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-2"><a href="data-dict.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-3"><a href="data-dict.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;date_arrived&quot;</span>,</span>
<span id="cb4-4"><a href="data-dict.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;date_departed&quot;</span>,</span>
<span id="cb4-5"><a href="data-dict.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;date_born&quot;</span>,</span>
<span id="cb4-6"><a href="data-dict.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;date_died&quot;</span></span>
<span id="cb4-7"><a href="data-dict.html#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="data-dict.html#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="data-dict.html#cb4-9" aria-hidden="true" tabindex="-1"></a>vars_numeric <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-10"><a href="data-dict.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cluster&quot;</span>,</span>
<span id="cb4-11"><a href="data-dict.html#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;age_months&quot;</span>,</span>
<span id="cb4-12"><a href="data-dict.html#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;age_years&quot;</span>,</span>
<span id="cb4-13"><a href="data-dict.html#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;muac&quot;</span></span>
<span id="cb4-14"><a href="data-dict.html#cb4-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-15"><a href="data-dict.html#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="data-dict.html#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> vars_date) {</span>
<span id="cb4-17"><a href="data-dict.html#cb4-17" aria-hidden="true" tabindex="-1"></a>  dat[[j]] <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(dat[[j]])</span>
<span id="cb4-18"><a href="data-dict.html#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="data-dict.html#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="data-dict.html#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> vars_numeric) {</span>
<span id="cb4-21"><a href="data-dict.html#cb4-21" aria-hidden="true" tabindex="-1"></a>  dat[[j]] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[[j]])</span>
<span id="cb4-22"><a href="data-dict.html#cb4-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-23"><a href="data-dict.html#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="data-dict.html#cb4-24" aria-hidden="true" tabindex="-1"></a>dict_dat <span class="ot">&lt;-</span> datadict<span class="sc">::</span><span class="fu">dict_from_data</span>(dat)</span>
<span id="cb4-25"><a href="data-dict.html#cb4-25" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(dict_dat, <span class="fu">here</span>(<span class="st">&quot;output/ex2_dict_dat.xlsx&quot;</span>))</span></code></pre></div>
<ul>
<li>Function <code>dict_from_data()</code> classifies some variables as “Coded list” that
<code>dict_from_odk()</code> classifies as “Free text” (<code>source_water_other</code>,
<code>ilness_other</code>, <code>cause_death_other</code>)</li>
<li>Various differences in column <code>choices</code> (order varies, some entries missing
with <code>dict_from_data()</code>, labels same but values differ)</li>
<li>Function <code>dict_from_odk()</code> retains extra columns from ODK data dictionary
(e.g. <code>constrain</code>, <code>relevant</code>, etc.)</li>
</ul>
</details>
</div>
<div id="exercise-3" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Exercise 3<a href="data-dict.html#exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Examine the options for the ‘Coded list’ type variables in the dictionary
produced in exercise 2, and compare these to the corresponding options produced
by <code>dict_from_odk()</code>. Why does the dictionary produced by <code>dict_from_data()</code>
have fewer ‘Coded list’ options for some variables? Does this matter in terms of
data sharing?</p>
<p>Hint: check out the function <code>datadict::coded_options()</code> to extract a long-form
table of Coded list variables and corresponding options from a dictionary.</p>
<details style="color:#b30000">
<summary>
<b>See proposed answer</b>
</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-dict.html#cb5-1" aria-hidden="true" tabindex="-1"></a>opts_dat <span class="ot">&lt;-</span> datadict<span class="sc">::</span><span class="fu">coded_options</span>(dict_dat)</span>
<span id="cb5-2"><a href="data-dict.html#cb5-2" aria-hidden="true" tabindex="-1"></a>opts_odk <span class="ot">&lt;-</span> datadict<span class="sc">::</span><span class="fu">coded_options</span>(dict_odk)</span>
<span id="cb5-3"><a href="data-dict.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="data-dict.html#cb5-4" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(opts_dat, <span class="fu">here</span>(<span class="st">&quot;output/ex3_opts_dat.xlsx&quot;</span>))</span>
<span id="cb5-5"><a href="data-dict.html#cb5-5" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(opts_odk, <span class="fu">here</span>(<span class="st">&quot;output/ex3_opts_odk.xlsx&quot;</span>))</span></code></pre></div>
<ul>
<li>Function <code>dict_from_data()</code> only includes options that appear in the dataset,
whereas <code>dict_from_odk()</code> includes all options from original ODK dictionary</li>
</ul>
</details>
</div>
<div id="exercise-4" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Exercise 4<a href="data-dict.html#exercise-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the function <code>valid_dict()</code> to check that the dictionary you produced in
Exercise 2 complies with the OCA standard. Assuming it does, edit the dictionary
so that it fails at least two of the checks implemented by <code>valid_dict()</code>.</p>
<details style="color:#b30000">
<summary>
<b>See proposed answer</b>
</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-dict.html#cb6-1" aria-hidden="true" tabindex="-1"></a>datadict<span class="sc">::</span><span class="fu">valid_dict</span>(dict_dat)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-dict.html#cb8-1" aria-hidden="true" tabindex="-1"></a>dict_dat_fail1 <span class="ot">&lt;-</span> dict_dat</span>
<span id="cb8-2"><a href="data-dict.html#cb8-2" aria-hidden="true" tabindex="-1"></a>dict_dat_fail1<span class="sc">$</span>variable_name[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb8-3"><a href="data-dict.html#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="data-dict.html#cb8-4" aria-hidden="true" tabindex="-1"></a>datadict<span class="sc">::</span><span class="fu">valid_dict</span>(dict_dat_fail1)</span></code></pre></div>
<pre><code>## Warning: - Missing values in column(s): &quot;variable_name&quot;</code></pre>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-dict.html#cb11-1" aria-hidden="true" tabindex="-1"></a>dict_dat_fail2 <span class="ot">&lt;-</span> dict_dat</span>
<span id="cb11-2"><a href="data-dict.html#cb11-2" aria-hidden="true" tabindex="-1"></a>dict_dat_fail2<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">&quot;Number&quot;</span></span>
<span id="cb11-3"><a href="data-dict.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="data-dict.html#cb11-4" aria-hidden="true" tabindex="-1"></a>datadict<span class="sc">::</span><span class="fu">valid_dict</span>(dict_dat_fail2)</span></code></pre></div>
<pre><code>## Warning: - Column `type` has nonvalid value(s): &quot;number&quot;</code></pre>
<pre><code>## [1] FALSE</code></pre>
</details>
</div>
<div id="exercise-5" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Exercise 5<a href="data-dict.html#exercise-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the function <code>valid_data()</code> to check for consistency between the dataset and
dictionary produced in Exercise 2. Assuming all checks pass, edit the dataset so
that it fails at least two of the checks implemented by <code>valid_data()</code>.</p>
<details style="color:#b30000">
<summary>
<b>See proposed answer</b>
</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-dict.html#cb14-1" aria-hidden="true" tabindex="-1"></a>datadict<span class="sc">::</span><span class="fu">valid_data</span>(dat, dict_dat)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-dict.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add nonvalid date</span></span>
<span id="cb16-2"><a href="data-dict.html#cb16-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.character</span>(dat<span class="sc">$</span>date)</span>
<span id="cb16-3"><a href="data-dict.html#cb16-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>date[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;July ?, 2021&quot;</span></span>
<span id="cb16-4"><a href="data-dict.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="data-dict.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># remove column present in dictionary</span></span>
<span id="cb16-6"><a href="data-dict.html#cb16-6" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>oedema <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-7"><a href="data-dict.html#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="data-dict.html#cb16-8" aria-hidden="true" tabindex="-1"></a>datadict<span class="sc">::</span><span class="fu">valid_data</span>(dat, dict_dat)</span></code></pre></div>
<pre><code>## Warning: - Columns defined in `dict` but not present in `data`: &quot;oedema&quot;
## - Variables of type &#39;Date&#39; contain nonvalid values: &quot;date&quot;</code></pre>
<pre><code>## [1] FALSE</code></pre>
</details>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pseudonym.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
